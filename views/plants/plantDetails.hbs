

<div class="plants-box">


{{#with plant}}


<h1 style="text-align: center;">{{species}}</h1>

<div class="plant-details-size-owner">
<p style="margin-right: 5%;"><strong>{{size}}</strong></p> 
<p>by <strong><u>{{user.username}}</u></strong></p>
</div>
<div class="plant-details-description">
<p>{{description}}</p>
<p>Can be picked up in <span>{{user.street}} {{user.house}}, {{user.zip}} {{user.city}}, {{user.country}}</span>.</p>
<p>Contact {{user.username}} for further details.</p>
</div>
<img src="{{imgPath}}" alt="My Plant Image" class="my-plant-image">
</div>
<div class="edit_buttons">
<form action="/plants/{{_id}}/edit" method="get">
    <button class="edit-plant-edit" type="submit">Edit Plant</button>
</form>
<form action="/plants/{{_id}}/delete" method="post">
    <button class="edit-plant-delete" type="submit">Delete Plant</button>
</form>
</div>
<div id="map" style='width: 400px; height: 300px;'></div>
<script src="https://unpkg.com/es6-promise@4.2.4/dist/es6-promise.auto.min.js"></script>
<script src="https://unpkg.com/@mapbox/mapbox-sdk/umd/mapbox-sdk.min.js"></script>
<script>
    let queryString="";
    let queryThings=document.querySelectorAll("span");
    for (thing of queryThings) {
        console.log(thing.innerText);
        queryString+=thing.innerText+" ";
    }
    console.log(queryString);
	mapboxgl.accessToken = 'pk.eyJ1IjoibXJ6c3p0ayIsImEiOiJja2NicXFtcHMyN2RrMnZtZ2JwY2prMXFtIn0.Kve-wkiKTqkaXiD3fgG0MA';
    var mapboxClient = mapboxSdk({ accessToken: mapboxgl.accessToken });
    mapboxClient.geocoding
        .forwardGeocode({
            query: queryString,
            autocomplete: false,
            limit: 1
        })
        .send()
        .then(function(response) {
            if (
                response &&
                response.body &&
                response.body.features &&
                response.body.features.length
            ) {
                var feature = response.body.features[0];

                var map = new mapboxgl.Map({
                    container: 'map',
                    style: 'mapbox://styles/mapbox/streets-v11',
                    center: feature.center,
                    zoom: 10
                });
                new mapboxgl.Marker().setLngLat(feature.center).addTo(map);
            }
        });
</script>
{{/with}} 

</div>
